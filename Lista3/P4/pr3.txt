APA: Aprenentatge Autom√†tic (TEMA 4)
Grau en Enginyeria Inform√†tica - UPC (2017/18)
Llu√≠s A. Belanche,

belanche@cs.upc.edu

Entrega: 13 Novembre 2017

Els problemes marcats

Objectius:

[G] s√≥n de grup; els problemes/apartats marcats [R] s√≥n per fer-se en R

1. Con√®ixer el comprom√≠s biaix/varian√ßa i la descomposici√≥ del risc total en el cas de la regressi√≥
2. Saber plantejar problemes de m√≠nims quadrats senzills i resoldre'ls per diferents m√©todes
Problema 1

Descomposici√≥ del risc en regressi√≥ [G]

Per tasques de regressi√≥ plantejades de la forma usual t = f (x) + , on E[] = 0 i V ar[] = œÉ 2 < ‚àû; pel
cas on  ‚àº N (0, œÉ 2 ), que porta a l'error quadr√†tic, el funcional de
d'un model y √©s:

risc total

Z Z

(t ‚àí y(x))2 p(t, x) dx dt,

R(y) =
R

Rd

que cal minimitzar respecte y . Sumant i restant f (x) dins del quadrat, R(y) es pot descomposar en
la suma de tres termes, que hem anomenat A, B i C , on:
‚Ä¢ A=

R R
R Rd

(t ‚àí f (x))2 p(t, x) dx dt

(f (x) ‚àí y(x))2 p(x) dx
R R
‚Ä¢ C = 2 R Rd (t ‚àí f (x))(f (x) ‚àí y(x))p(t, x) dx dt
‚Ä¢ B=

R

Rd

1. Demostreu que A =RœÉ 2 . Pista:
cal un canvi
‚àö de variable per introduir ; despr√©s, si us cal, podeu
2 2
‚àû
usar que per a > 0, 0 u2 e‚àía u du = 14 œÄa‚àí3 .
2. Demostreu que C = 0.
3. Interpreteu el resultat nal en termes de A, B . Useu els conceptes de biaix i varian√ßa.
.........

Problema 2

Regressi√≥ lineal ponderada

En regressi√≥ lineal, sota la suposici√≥ que el soroll gaussi√† √©s homoced√†stic, la maximitzaci√≥ de la funci√≥
log-versemblan√ßa √©s equivalent a la minimitzaci√≥ de l'error quadr√†tic. En el cas d'heterocedasticitat, fem
tn = f (xn ) + n , on n ‚àº N (0, œÉn2 ). Llavors la maximitzaci√≥ de la funci√≥ log-versemblan√ßa √©s equivalent
a la minimitzaci√≥ de l'error quadr√†tic ponderat (vegeu el problema 7 del TEMA 1):
E(w) =

N
1X
an (tn ‚àí y(xn ; w))2
2 n=1

on an = œÉn‚àí2 , de manera que l'optimitzaci√≥ dona menys import√†ncia a aquells exemples amb m√©s
variabilitat condicional (i, per tant, menys representatius de la mitjana). Volem ara resoldre aquest
tipus de problemes d'una forma m√©s general, de la seg√ºent manera. Suposem que partim del problema
de m√≠nims quadrats:

TEMA 4

APA: Aprenentatge Autom√†tic

min E(w) = (t ‚àí Œ¶w)T A (t ‚àí Œ¶w)
w

on Œ¶ √©s la matriu de disseny i A √©s una matriu sim√®trica i semi-denida positiva (PSD).
1. Determineu una matriu A tal que s'obtingui el resultat del problema 10 del TEMA 1.
2. Resoleu (en w) el problema general de m√≠nims quadrats per matrius A PSD arbitr√†ries.
.........
Problema 3

Interacci√≥ entre part√≠cules [R,G]

S'ha dissenyat un experiment per provar una teoria sobre la naturalesa de la interacci√≥ entre certs tipus
de part√≠cules elementals en col¬∑lisi√≥ amb protons. Es creu que la secci√≥ transversal est√† linealment
relacionada amb la inversa de l'energia. A tal efecte, s'han determinat submostres per diferents nivells
de la in√®rcia de la part√≠cula. En cada submostra es van prendre un gran nombre d'observacions i aix√≤ ha
perm√®s estimar la desviaci√≥ est√†ndar (sd) de la secci√≥ transversal (st) mesurada, com indica la Taula 1.
energia st sd
2.899 367 17
3.484 311 9
3.984 295 9
4.444 268 7
4.831 253 7
5.376 239 6
6.211 220 6
7.576 213 6
11.905 193 5
16.667 192 5

Taula 1: Interacci√≥ entre part√≠cules
Plantegeu el problema de predir la secci√≥ transversal amb la inversa de l'energia com una regressi√≥
lineal ponderada (vegeu el problema 7 del TEMA 1). Resoleu-lo num√®ricament usant la rutina lm() (√≥
glm() si especiqueu family=gaussian). Feu un gr√†c del resultat amb i sense la ponderaci√≥; compareu
els resultat i expliqueu la ra√≥ de les difer√®ncies.
.........
Problema 4

Propietats el√†stiques d'una molla [R]

Volem determinar les propietats el√†stiques d'una molla usant diferents pesos i mesurant la deformaci√≥
que es produeix. La llei de Hooke relaciona la longitud l i la for√ßa F que exerceix el pes com:
e + kF = l

on e, k s√≥n constants de la llei, que es volen determinar. S'ha realitzat un experiment i obtingut les
dades:
F
1
2
3
4
5
l 7.97 10.2 14.2 16.0 21.2
1. Plantegeu el problema com un problema de m√≠nims quadrats
2. Resoleu-lo amb el m√©tode de la matriu pseudo-inversa
3. Resoleu-lo amb el m√©tode basat en la SVD
.........

2

TEMA 4

APA: Aprenentatge Autom√†tic

Problema 5

Ajustant un petit polinomi [R]

En un problema de regressi√≥ univariant es tenen les parelles d'exemples {(‚àí1, 2), (1, 1), (2, 1), (3, 0), (5, 3)}.
Es vol ajustar un polinomi de grau dos de la forma y(x) = c0 + c1 x + c2 x2 .
1. Plantegeu el problema com un problema de m√≠nims quadrats
2. Resoleu-lo amb el m√©tode de la matriu pseudo-inversa
3. Feu un gr√†c amb les dades i la soluci√≥ obtinguda
.........

Problema 6

C√†lcul d'√≤rbites [R,G]

El cometa Tentax es va descobrir al 1968 i t√© una √≤rbita quadr√†tica (el¬∑l√≠ptica, parab√≤lica o hiperb√≤lica)
d'acord a les lleis de Kepler. L'√≤rbita t√© l'equaci√≥:
r=

p
1 ‚àí e cos œÜ

on p √©s un coecient espec√≠c per aquest cometa, e √©s l'excentricitat (totes dues desconegudes) i les
parelles (r, œÜ) indiquen les diferents posicions observades (en coordenades polars amb centre en el Sol).
Els astr√≤noms han reunit un conjunt de coordenades:
{(2.70, 48 ‚ó¶ ), (2.00, 67 ‚ó¶ ), (1.61, 83 ‚ó¶ ), (1.20, 108 ‚ó¶ ), (1.02, 126 ‚ó¶ )}

1. Escriviu el problema com un sistema lineal
2. Trobeu les dues constants p, e per m√≠nims quadrats
.........

Problema 7

Equival√®ncia de solucions

‚àí1

La soluci√≥ del problema min ||y ‚àí Ax||2 + ŒªxT Cx √©s x‚àó = AT A + ŒªC
AT y , on C √©s una matriu
x
semi-denida positiva. Utilitzeu aquest resultatper demostrar formalment que la soluci√≥ del problema
‚àí1 T
min ||y ‚àí Ax||2 + ||Bx||2 √©s x‚àó = AT A + B T B
A y.
x

.........

Problema 8

Producci√≥ anual de minerals [R]

Una empresa extreia un mineral preci√≥s i portava un registre anual de la massa extreta (en tones m√®triques, equivalents a 1.000 quilos). Per la d√®cada dels 70 es va obtenir la producci√≥ de la Taula 2.
1. Plantegeu i resoleu num√®ricament el problema de predir la producci√≥ en funci√≥ de l'any usant la
rutina lm() (√≥ glm() si especiqueu family=gaussian). Feu un gr√†c amb les dades i la soluci√≥
obtinguda
2. Si no hi ha hag√∫es cap inu√®ncia externa forta que provoqu√©s variacions substancials en la producci√≥, quina seria la previssi√≥ de producci√≥ per 1984? Doneu un interval de conan√ßa al 95%.
.........

3

TEMA 4

APA: Aprenentatge Autom√†tic

Any
1970
1971
1972
1973
1974
1975
1976
1977
1978
1979

Tones
9
9
10
10
8
6
6
4
6
4

Taula 2: Producci√≥ de minerals
Dest√≠
Dist√†ncia Tarifa
Atlanta
576
178
Boston
370
138
Chicago
612
94
Dallas
1216
278
Detroit
409
158
Denver
1502
258
Miami
946
198
New Orleans 998
188
New York
189
98
Orlando
787
179
Pittsburgh
210
138
St. Louis
737
98

Taula 3: Viatjant pels EEUU
Problema 9

Viatjant pels EEUU [R]

La Taula 3 mostra les dist√†ncies (en milles) entre Baltimore i altres 12 ciutats dels EEUU, juntament
amb el preu del bitllet d'avi√≥ (en d√≤lars) entre elles.
1. Plantegeu i resoleu num√®ricament el problema de predir la Tarifa amb la Dist√†ncia usant la
rutina lm() (√≥ glm() si especiqueu family=gaussian). Feu un gr√†c amb les dades i la soluci√≥
obtinguda
2. Observareu que algunes ciutats tenen tarifes anormalment baixes per la dist√†ncia a la que es troben.
Dissenyeu una manera de reduir la inu√®ncia d'aquests casos i recalculeu la soluci√≥.
.........
Problema 10

Interpolaci√≥ polin√≤mica

El problema d'interpolar un conjunt de punts {(x1 , t1 ), . . . , (xN , tN )} amb una funci√≥ f consisteix a
for√ßar que f (xn ) = tn , per tot n. Assumint que tots els xn s√≥n diferents entre s√≠, aquesta tasca √©s
resoluble amb un polinomi de grau N ‚àí 1. Es demana:
1. Deniu el vector t = (t1 , . . . , tn )T i la matriu de disseny Œ¶ convenientment, expresseu el problema
en format matricial i ressoleu-lo. Pista: la matriu Œ¶ que en resulta es coneix com matriu de
Vandermonde.
2. Apliqueu el resultat a dades de la vostra elecci√≥ amb N = 10 i comproveu la qualitat de la soluci√≥.
.........

4

